vulnerability_id: VCID-6763-eu92-aaab
aliases:
  - CVE-2019-20920
  - GHSA-3cqr-58rm-57f8
summary: |
  Improper Control of Generation of Code ('Code Injection')
  Handlebars before 3.0.8 and 4.x before 4.5.3 is vulnerable to Arbitrary Code Execution. The lookup helper fails to properly validate templates, allowing attackers to submit templates that execute arbitrary JavaScript. This can be used to run arbitrary code on a server processing Handlebars templates or in a victim's browser (effectively serving as XSS).
severities:
  - id: 693189
    reference_id: 1453832
    scoring_system: generic_textual
    value: Medium
    scoring_elements:
  - id: 67337
    reference_id: '196648'
    scoring_system: cvssv3
    value: '8.1'
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:H/I:L/A:L
  - id: 693190
    reference_id: 1453833
    scoring_system: generic_textual
    value: Medium
    scoring_elements:
  - id: 693191
    reference_id: 35095
    scoring_system: generic_textual
    value: Medium
    scoring_elements:
  - id: 693192
    reference_id: 35096
    scoring_system: generic_textual
    value: Medium
    scoring_elements:
  - id: 693193
    reference_id: 35067
    scoring_system: generic_textual
    value: Medium
    scoring_elements:
  - id: 67336
    reference_id: '196647'
    scoring_system: rhbs
    value: medium
    scoring_elements:
  - id: 401378
    reference_id: 35093
    scoring_system: cvssv2
    value: '6.8'
    scoring_elements: AV:N/AC:M/Au:N/C:P/I:P/A:P
  - id: 401376
    reference_id: 35093
    scoring_system: cvssv3
    value: '8.1'
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:H/I:L/A:L
  - id: 706076
    reference_id: 35097
    scoring_system: cvssv3.1_qr
    value: HIGH
    scoring_elements:
  - id: 50740
    reference_id: 175320
    scoring_system: rhas
    value: Low
    scoring_elements:
  - id: 67279
    reference_id: '196556'
    scoring_system: rhas
    value: Moderate
    scoring_elements:
  - id: 48767
    reference_id: 173113
    scoring_system: rhas
    value: Important
    scoring_elements:
references:
  - id: 1453832
    url: http://people.canonical.com/~ubuntu-security/cve/2019/CVE-2019-20920.html
    reference_id:
  - id: '196648'
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2019-20920.json
    reference_id:
  - id: 1453833
    url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-20920
    reference_id:
  - id: 35094
    url: https://github.com/handlebars-lang/handlebars.js/commit/d54137810a49939fd2ad01a91a34e182ece4528e
    reference_id:
  - id: 35095
    url: https://snyk.io/vuln/SNYK-JS-HANDLEBARS-534478
    reference_id:
  - id: 35096
    url: https://www.npmjs.com/advisories/1316
    reference_id:
  - id: 35067
    url: https://www.npmjs.com/advisories/1324
    reference_id:
  - id: 35075
    url: https://www.npmjs.com/package/handlebars
    reference_id:
  - id: '196647'
    url: https://bugzilla.redhat.com/show_bug.cgi?id=1882260
    reference_id: 1882260
  - id: 793467
    url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:handlebarsjs:handlebars:*:*:*:*:*:node.js:*:*
    reference_id: cpe:2.3:a:handlebarsjs:handlebars:*:*:*:*:*:node.js:*:*
  - id: 35093
    url: https://nvd.nist.gov/vuln/detail/CVE-2019-20920
    reference_id: CVE-2019-20920
  - id: 35097
    url: https://github.com/advisories/GHSA-3cqr-58rm-57f8
    reference_id: GHSA-3cqr-58rm-57f8
  - id: 175320
    url: https://access.redhat.com/errata/RHSA-2020:5179
    reference_id: RHSA-2020:5179
  - id: '196556'
    url: https://access.redhat.com/errata/RHSA-2021:2500
    reference_id: RHSA-2021:2500
  - id: 173113
    url: https://access.redhat.com/errata/RHSA-2021:3917
    reference_id: RHSA-2021:3917
weaknesses: []
