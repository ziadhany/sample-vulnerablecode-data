vulnerability_id: VCID-3e66-27uu-aaah
aliases:
  - CVE-2022-39386
  - GHSA-4pcg-wr6c-h9cq
  - GMS-2022-6369
  - GMS-2022-6380
summary: |
  Crash on malformed packet
  @fastify/websocket provides WebSocket support for Fastify. Any application using @fastify/websocket could crash if a specific, malformed packet is sent. All versions of fastify-websocket are also impacted. That module is deprecated, so it will not be patched. This has been patched in version 7.1.1 (fastify v4) and version 5.0.1 (fastify v3). There are currently no known workarounds. However, it should be possible to attach the error handler manually. The recommended path is upgrading to the patched versions.
severities:
  - id: 707261
    reference_id: 1463621
    scoring_system: cvssv3.1_qr
    value: HIGH
    scoring_elements:
  - id: 707260
    reference_id: 1463565
    scoring_system: cvssv3.1_qr
    value: HIGH
    scoring_elements:
references:
  - id: 1472705
    url: https://github.com/fastify/fastify-websocket/commit/7e8c41a51c101c3d5ce88caee4f71d9c29eb2863
    reference_id:
  - id: 1472706
    url: https://github.com/fastify/fastify-websocket/commit/c24adeb3efd57a18b2f287c35d029e88b5a47194
    reference_id:
  - id: 1470509
    url: https://github.com/fastify/fastify-websocket/pull/228
    reference_id:
  - id: 1463619
    url: https://github.com/fastify/fastify-websocket/releases/tag/v5.0.1
    reference_id:
  - id: 1463620
    url: https://github.com/fastify/fastify-websocket/releases/tag/v7.1.1
    reference_id:
  - id: 1463564
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-39386
    reference_id: CVE-2022-39386
  - id: 1463621
    url: https://github.com/advisories/GHSA-4pcg-wr6c-h9cq
    reference_id: GHSA-4pcg-wr6c-h9cq
  - id: 1463565
    url: https://github.com/fastify/fastify-websocket/security/advisories/GHSA-4pcg-wr6c-h9cq
    reference_id: GHSA-4pcg-wr6c-h9cq
weaknesses: []
