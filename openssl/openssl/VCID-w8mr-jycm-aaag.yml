vulnerability_id: VCID-w8mr-jycm-aaag
aliases:
  - CVE-2016-0701
  - VC-OPENSSL-20160128-CVE-2016-0701
summary: 'Historically OpenSSL usually only ever generated DH parameters based on "safe" primes.
  More recently (in version 1.0.2) support was provided for generating X9.42 style parameter
  files such as those required for RFC 5114 support. The primes used in such files may not be
  "safe". Where an application is using DH configured with parameters based on primes that are
  not "safe" then an attacker could use this fact to find a peer''s private DH exponent. This
  attack requires that the attacker complete multiple handshakes in which the peer uses the
  same private DH exponent. For example this could be used to discover a TLS server''s private
  DH exponent if it''s reusing the private DH exponent or it''s using a static DH ciphersuite.
  OpenSSL provides the option SSL_OP_SINGLE_DH_USE for ephemeral DH (DHE) in TLS. It is not
  on by default. If the option is not set then the server reuses the same private DH exponent
  for the life of the server process and would be vulnerable to this attack. It is believed
  that many popular applications do set this option and would therefore not be at risk. OpenSSL
  before 1.0.2f will reuse the key if: - SSL_CTX_set_tmp_dh()/SSL_set_tmp_dh() is used and SSL_OP_SINGLE_DH_USE
  is not set. - SSL_CTX_set_tmp_dh_callback()/SSL_set_tmp_dh_callback() is used, and both the
  parameters and the key are set and SSL_OP_SINGLE_DH_USE is not used. This is an undocumted
  feature and parameter files don''t contain the key. - Static DH ciphersuites are used. The
  key is part of the certificate and so it will always reuse it. This is only supported in 1.0.2.
  It will not reuse the key for DHE ciphers suites if: - SSL_OP_SINGLE_DH_USE is set - SSL_CTX_set_tmp_dh_callback()/SSL_set_tmp_dh_callback()
  is used and the callback does not provide the key, only the parameters. The callback is almost
  always used like this. Non-safe primes are generated by OpenSSL when using: - genpkey with
  the dh_rfc5114 option. This will write an X9.42 style file including the prime-order subgroup
  size "q". This is supported since the 1.0.2 version. Older versions can''t read files generated
  in this way. - dhparam with the -dsaparam option. This has always been documented as requiring
  the single use. The fix for this issue adds an additional check where a "q" parameter is available
  (as is the case in X9.42 based parameters). This detects the only known attack, and is the
  only possible defense for static DH ciphersuites. This could have some performance impact.
  Additionally the SSL_OP_SINGLE_DH_USE option has been switched on by default and cannot be
  disabled. This could have some performance impact.'
severities:
  - id: 623
    reference_id: 3673
    scoring_system: generic_textual
    value: High
    scoring_elements:
  - id: 697874
    reference_id: 495
    scoring_system: generic_textual
    value: Medium
    scoring_elements:
  - id: 697817
    reference_id: 2757
    scoring_system: generic_textual
    value: Low
    scoring_elements:
  - id: 696536
    reference_id: 406
    scoring_system: generic_textual
    value: Medium
    scoring_elements:
  - id: 696630
    reference_id: 278
    scoring_system: generic_textual
    value: Medium
    scoring_elements:
  - id: 693466
    reference_id: 2746
    scoring_system: generic_textual
    value: Medium
    scoring_elements:
  - id: 668480
    reference_id: 158996
    scoring_system: generic_textual
    value: Medium
    scoring_elements:
  - id: 673335
    reference_id: 13679
    scoring_system: generic_textual
    value: Medium
    scoring_elements:
  - id: 51457
    reference_id: 176137
    scoring_system: rhbs
    value: medium
    scoring_elements:
  - id: 211040
    reference_id: 624757
    scoring_system: cvssv2
    value: '2.6'
    scoring_elements: AV:N/AC:H/Au:N/C:P/I:N/A:N
  - id: 211038
    reference_id: 624757
    scoring_system: cvssv3
    value: '3.7'
    scoring_elements: CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:N/A:N
references:
  - id: 624751
    url: http://intothesymmetry.blogspot.com/2016/01/openssl-key-recovery-attack-on-dh-small.html
    reference_id:
  - id: 600770
    url: http://kb.juniper.net/InfoCenter/index?page=content&id=JSA10759
    reference_id:
  - id: 606298
    url: http://lists.fedoraproject.org/pipermail/package-announce/2016-January/176373.html
    reference_id:
  - id: 594669
    url: http://lists.opensuse.org/opensuse-security-announce/2016-03/msg00009.html
    reference_id:
  - id: 176138
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2016-0701.json
    reference_id:
  - id: 624754
    url: https://git.openssl.org/?p=openssl.git;a=commit;h=878e2c5b13010329c203f309ed0c8f2113f85648
    reference_id:
  - id: 624755
    url: https://git.openssl.org/?p=openssl.git;a=commit;h=c5b831f21d0d29d1e517d139d9d101763f60c9a2
    reference_id:
  - id: 606305
    url: https://h20566.www2.hpe.com/hpsc/doc/public/display?docLocale=en_US&docId=emr_na-hpesbhf03724en_us
    reference_id:
  - id: 624756
    url: https://h20566.www2.hpe.com/portal/site/hpsc/public/kb/docDisplay?docId=emr_na-c05164821
    reference_id:
  - id: 606306
    url: https://h20566.www2.hpe.com/portal/site/hpsc/public/kb/docDisplay?docId=emr_na-c05390893
    reference_id:
  - id: 606308
    url: https://security.gentoo.org/glsa/201601-05
    reference_id:
  - id: 606309
    url: https://www.kb.cert.org/vuls/id/257823
    reference_id:
  - id: 3673
    url: https://www.openssl.org/news/secadv/20160128.txt
    reference_id:
  - id: 495
    url: https://www.oracle.com/security-alerts/cpuapr2020.html
    reference_id:
  - id: 2757
    url: https://www.oracle.com/security-alerts/cpujan2020.html
    reference_id:
  - id: 406
    url: https://www.oracle.com/security-alerts/cpujul2020.html
    reference_id:
  - id: 278
    url: https://www.oracle.com/security-alerts/cpuoct2020.html
    reference_id:
  - id: 2746
    url: https://www.oracle.com/technetwork/security-advisory/cpujul2019-5072835.html
    reference_id:
  - id: 606301
    url: http://www.openssl.org/news/secadv/20160128.txt
    reference_id:
  - id: 158996
    url: http://www.oracle.com/technetwork/security-advisory/cpujul2016-2881720.html
    reference_id:
  - id: 13679
    url: http://www.oracle.com/technetwork/security-advisory/cpuoct2017-3236626.html
    reference_id:
  - id: 624752
    url: http://www.securityfocus.com/bid/82233
    reference_id:
  - id: 27477
    url: http://www.securityfocus.com/bid/91787
    reference_id:
  - id: 606303
    url: http://www.securitytracker.com/id/1034849
    reference_id:
  - id: 624753
    url: http://www.ubuntu.com/usn/USN-2883-1
    reference_id:
  - id: 176137
    url: https://bugzilla.redhat.com/show_bug.cgi?id=1301845
    reference_id: 1301845
  - id: 594091
    url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:openssl:openssl:1.0.2:*:*:*:*:*:*:*
    reference_id: cpe:2.3:a:openssl:openssl:1.0.2:*:*:*:*:*:*:*
  - id: 600723
    url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:openssl:openssl:1.0.2a:*:*:*:*:*:*:*
    reference_id: cpe:2.3:a:openssl:openssl:1.0.2a:*:*:*:*:*:*:*
  - id: 600765
    url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:openssl:openssl:1.0.2b:*:*:*:*:*:*:*
    reference_id: cpe:2.3:a:openssl:openssl:1.0.2b:*:*:*:*:*:*:*
  - id: 594092
    url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:openssl:openssl:1.0.2:beta1:*:*:*:*:*:*
    reference_id: cpe:2.3:a:openssl:openssl:1.0.2:beta1:*:*:*:*:*:*
  - id: 594093
    url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:openssl:openssl:1.0.2:beta2:*:*:*:*:*:*
    reference_id: cpe:2.3:a:openssl:openssl:1.0.2:beta2:*:*:*:*:*:*
  - id: 594094
    url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:openssl:openssl:1.0.2:beta3:*:*:*:*:*:*
    reference_id: cpe:2.3:a:openssl:openssl:1.0.2:beta3:*:*:*:*:*:*
  - id: 600766
    url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:openssl:openssl:1.0.2c:*:*:*:*:*:*:*
    reference_id: cpe:2.3:a:openssl:openssl:1.0.2c:*:*:*:*:*:*:*
  - id: 600779
    url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:openssl:openssl:1.0.2d:*:*:*:*:*:*:*
    reference_id: cpe:2.3:a:openssl:openssl:1.0.2d:*:*:*:*:*:*:*
  - id: 606312
    url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:openssl:openssl:1.0.2e:*:*:*:*:*:*:*
    reference_id: cpe:2.3:a:openssl:openssl:1.0.2e:*:*:*:*:*:*:*
  - id: 624757
    url: https://nvd.nist.gov/vuln/detail/CVE-2016-0701
    reference_id: CVE-2016-0701
weaknesses: []
