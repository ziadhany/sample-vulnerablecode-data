vulnerability_id: VCID-ku69-tbaa-aaah
aliases:
  - CVE-2017-15806
summary: |
  Arbitrary code execution via a crafted email address
  The send function in the `ezcMailMtaTransport` class does not properly restrict the set of characters used in the `ezcMail` `returnPath` property, which might allow remote attackers to execute arbitrary code via a crafted email address, as demonstrated by one containing "-X/path/to/wwwroot/file.php."
severities:
  - id: 268904
    reference_id: 686790
    scoring_system: cvssv2
    value: '6.8'
    scoring_elements: AV:N/AC:M/Au:N/C:P/I:P/A:P
  - id: 268902
    reference_id: 686790
    scoring_system: cvssv3
    value: '8.1'
    scoring_elements: CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H
references:
  - id: 24782
    url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-15806
    reference_id:
  - id: 24783
    url: https://github.com/zetacomponents/Mail/issues/58
    reference_id:
  - id: 24784
    url: https://github.com/zetacomponents/Mail/releases/tag/1.8.2
    reference_id:
  - id: 686787
    url: https://kay-malwarebenchmark.github.io/blog/cve-2017-15806-critical-rce-vulnerability/
    reference_id:
  - id: 686788
    url: https://kay-malwarebenchmark.github.io/blog/cve-2017-15806-yuan-cheng-dai-ma-zhi-xing-lou-dong/
    reference_id:
  - id: 686789
    url: https://www.exploit-db.com/exploits/43155/
    reference_id:
  - id: 686786
    url: http://www.securityfocus.com/bid/101866
    reference_id:
  - id: 686791
    url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:zetacomponents:mail:*:*:*:*:*:*:*:*
    reference_id: cpe:2.3:a:zetacomponents:mail:*:*:*:*:*:*:*:*
  - id: 686790
    url: https://nvd.nist.gov/vuln/detail/CVE-2017-15806
    reference_id: CVE-2017-15806
weaknesses: []
