vulnerability_id: VCID-n5j6-y7ju-aaap
aliases:
  - CVE-2017-18122
summary: |
  Improper Verification of Cryptographic Signature
  A SimpleSAMLphp Service Provider using SAML will regard as valid any unsigned SAML response containing more than one signed assertion, provided that the signature of at least one of the assertions is valid. Attributes contained in all the assertions received will be merged and the entityID of the first assertion received will be used, allowing an attacker to impersonate any user of any IdP given an assertion signed by the targeted IdP.
severities:
  - id: 677346
    reference_id: 1441450
    scoring_system: generic_textual
    value: Medium
    scoring_elements:
  - id: 677347
    reference_id: 1441451
    scoring_system: generic_textual
    value: Medium
    scoring_elements:
  - id: 677348
    reference_id: 24749
    scoring_system: generic_textual
    value: Medium
    scoring_elements:
  - id: 276216
    reference_id: 24748
    scoring_system: cvssv2
    value: '6.8'
    scoring_elements: AV:N/AC:M/Au:N/C:P/I:P/A:P
  - id: 276214
    reference_id: 24748
    scoring_system: cvssv3
    value: '8.1'
    scoring_elements: CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H
references:
  - id: 1441450
    url: http://people.canonical.com/~ubuntu-security/cve/2017/CVE-2017-18122.html
    reference_id:
  - id: 1441451
    url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-18122
    reference_id:
  - id: 693006
    url: https://lists.debian.org/debian-lts-announce/2018/02/msg00008.html
    reference_id:
  - id: 24749
    url: https://simplesamlphp.org/security/201710-01
    reference_id:
  - id: 20022
    url: https://www.debian.org/security/2018/dsa-4127
    reference_id:
  - id: 123901
    url: https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=889286
    reference_id: 889286
  - id: 171183
    url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:simplesamlphp:simplesamlphp:*:*:*:*:*:*:*:*
    reference_id: cpe:2.3:a:simplesamlphp:simplesamlphp:*:*:*:*:*:*:*:*
  - id: 79274
    url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:debian:debian_linux:7.0:*:*:*:*:*:*:*
    reference_id: cpe:2.3:o:debian:debian_linux:7.0:*:*:*:*:*:*:*
  - id: 79275
    url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:debian:debian_linux:8.0:*:*:*:*:*:*:*
    reference_id: cpe:2.3:o:debian:debian_linux:8.0:*:*:*:*:*:*:*
  - id: 127310
    url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:debian:debian_linux:9.0:*:*:*:*:*:*:*
    reference_id: cpe:2.3:o:debian:debian_linux:9.0:*:*:*:*:*:*:*
  - id: 24748
    url: https://nvd.nist.gov/vuln/detail/CVE-2017-18122
    reference_id: CVE-2017-18122
weaknesses: []
